<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="theme-color" content="#04000a">
<title>ТОЛСТЯК 4.0 — Исправлено</title>

<script>
  // Этот скрипт должен быть ПЕРВЫМ. Он чинит пути для Capacitor и GitHub
  (function() {
    var base = document.createElement('base');
    base.href = document.location.pathname.indexOf('index.html') !== -1 
      ? document.location.pathname.replace('index.html', '') 
      : document.location.pathname;
    document.head.appendChild(base);
    console.log("Base path set to: " + base.href);
  })();

  // Отлов ошибок для диагностики (выведет окно, если игра упадет)
  window.onerror = function(msg, url, line) {
    alert("ОШИБКА ИГРЫ:\n" + msg + "\nФайл: " + url + "\nСтрока: " + line);
    return false;
  };
</script>

<style>
:root{
  --pink:#ff3d7f;--purple:#9b00ff;--gold:#ffd700;--green:#00ff88;
  --bg:#04000a;--card:rgba(255,255,255,0.06);--border:rgba(255,255,255,0.11);
  --font: 'Arial Black', Gadget, sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{width:100%;height:100%;overflow:hidden;background:var(--bg);color:#fff;font-family:sans-serif;position:fixed;}

/* Экран загрузки */
#loadScreen{
  position:fixed;inset:0;z-index:9999;
  background:linear-gradient(135deg,#0a0018 0%,#1a0035 100%);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
}
.load-bar-wrap{width:80%;background:rgba(255,255,255,0.1);border-radius:99px;height:20px;margin-top:20px;border:1px solid var(--gold);}
#loadBarFill{height:100%;width:0%;background:var(--pink);transition:width 0.3s;}
</style>
</head>
<body>

<div id="loadScreen">
  <div style="font-size:40px; font-weight:bold; color:var(--gold);">ТОЛСТЯК 4.0</div>
  <div class="load-bar-wrap"><div id="loadBarFill"></div></div>
  <div id="statusTxt" style="margin-top:10px; font-size:12px; color:#666;">Загрузка ресурсов...</div>
</div>

<canvas id="gameCanvas"></canvas>

<div id="ui" style="display:none;">
  </div>

<script>
/** * СЕКЦИЯ ДВИЖКА ИГРЫ
 * Если у тебя есть файл main.js, убедись что он лежит рядом с index.html
 */

// Заглушки, чтобы не было ошибок "not defined"
window.gs = { weight: 100, coins: 0, energy: 100 }; 
window.openPanel = function(id) { console.log("Open panel:", id); };
window.updateHUD = function() { console.log("HUD Updated"); };

// Логика исчезновения экрана загрузки
window.addEventListener('load', function() {
  const bar = document.getElementById('loadBarFill');
  const status = document.getElementById('statusTxt');
  
  let p = 0;
  let interval = setInterval(() => {
    p += 10;
    bar.style.width = p + '%';
    if(p >= 100) {
      clearInterval(interval);
      document.getElementById('loadScreen').style.display = 'none';
      document.getElementById('ui').style.display = 'block';
      console.log("Игра запущена!");
    }
  }, 100);
});
</script>

<script src="main.js" onerror="console.error('Файл main.js не найден!')"></script>

</body>
</html>
